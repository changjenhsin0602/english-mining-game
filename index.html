<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>è‹±æ–‡æŒ–ç¤¦éŠæˆ² v8ï¼ˆå¯¶çŸ³ï¼‹æŒè²ç‰ˆ B1L3+B1L4 è‹±é¸ä¸­ï¼‰</title>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: Arial, "å¾®è»Ÿæ­£é»‘é«”", sans-serif;
      margin: 0;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #1c92d2 0%, #f2fcfe 40%, #fceabb 100%);
    }
    .game-wrapper {
      width: 95%;
      max-width: 800px;
      background: rgba(255, 255, 255, 0.96);
      border-radius: 18px;
      box-shadow: 0 12px 30px rgba(0,0,0,0.18);
      padding: 24px 22px 26px;
    }
    .game-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }
    .title { font-size: 22px; font-weight: bold; }
    .badge {
      font-size: 12px;
      padding: 4px 10px;
      border-radius: 999px;
      background: #ffe08a;
      color: #5c3b00;
    }
    .status-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
      font-size: 16px;
    }
    .status-label { font-weight: 600; }
    .ore-display {
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    #oreIcons { font-size: 20px; }
    #oreNumber {
      font-size: 18px;
      font-weight: bold;
      color: #e67e22;
      min-width: 32px;
      text-align: right;
    }
    #roundInfo { font-size: 13px; color: #6b7280; }

    /* æŒ–ç¤¦å€ï¼šæ¯”é¡Œç›®å¡å°ä¸€é» */
    .toolbar {
      text-align: center;
      padding: 6px 10px 8px;
      border-radius: 999px;
      background: linear-gradient(90deg, #0ea5e9 0%, #22c55e 50%, #facc15 100%);
      display: inline-block;
      margin: 0 auto 4px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.15);
    }
    .toolbar-inner {
      background: #ffffff;
      border-radius: 999px;
      padding: 3px 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    #mineBtn {
      padding: 7px 18px;
      font-size: 16px;
      border-radius: 999px;
      cursor: pointer;
      border: none;
      background: linear-gradient(135deg, #22c55e, #16a34a);
      color: #fff;
      box-shadow: 0 3px 9px rgba(34,197,94,0.5);
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: transform 0.12s ease, box-shadow 0.12s ease, filter 0.12s ease;
    }
    #mineBtn .icon { font-size: 18px; }
    #mineBtn .label { letter-spacing: 0.04em; }

    @keyframes pulseGlow {
      0%   { transform: translateY(0) scale(1);   box-shadow: 0 3px 9px rgba(34,197,94,0.5); filter: brightness(1); }
      50%  { transform: translateY(-1px) scale(1.05); box-shadow: 0 6px 14px rgba(34,197,94,0.75); filter: brightness(1.08); }
      100% { transform: translateY(0) scale(1);   box-shadow: 0 3px 9px rgba(34,197,94,0.5); filter: brightness(1); }
    }
    #mineBtn.attention { animation: pulseGlow 1.9s ease-in-out infinite; }
    #mineBtn:hover {
      transform: translateY(-1px) scale(1.03);
      box-shadow: 0 6px 14px rgba(34,197,94,0.75);
    }
    #mineBtn:active {
      transform: translateY(0px) scale(0.98);
      box-shadow: 0 2px 6px rgba(34,197,94,0.6);
      filter: brightness(0.95);
    }

    #questionArea { margin-top: 12px; }
    .card {
      border-radius: 16px;
      background: #f8fafc;
      padding: 20px 18px 16px;
      border: 1px solid #dbe3f0;
      box-shadow: 0 6px 14px rgba(148,163,184,0.45);
      transform-origin: center;
    }
    @keyframes cardPop {
      0%   { transform: scale(0.9) translateY(8px); opacity: 0; }
      50%  { transform: scale(1.03) translateY(-2px); opacity: 1; }
      100% { transform: scale(1) translateY(0); opacity: 1; }
    }
    .card.pop { animation: cardPop 0.28s ease-out; }

    #lessonTag { font-size: 12px; color: #6b7280; margin-bottom: 4px; }
    #questionText { font-size: 18px; margin-bottom: 10px; font-weight: 600; }
    #optionsArea { margin-top: 6px; }

    .option-btn {
      padding: 8px 14px;
      margin: 4px;
      font-size: 16px;
      border-radius: 999px;
      cursor: pointer;
      display: inline-block;
      border: 1px solid transparent;
      color: #111827;
      transition: transform 0.05s ease, box-shadow 0.15s ease, filter 0.1s ease;
    }
    .option-btn:hover {
      box-shadow: 0 2px 6px rgba(148,163,184,0.5);
      transform: translateY(-1px);
      filter: brightness(1.05);
    }
    .option-btn:active {
      transform: translateY(1px);
      box-shadow: none;
      filter: brightness(0.96);
    }

    #message { margin-top: 14px; font-size: 16px; min-height: 24px; }
    #message.correct { color: #16a34a; }
    #message.wrong   { color: #b91c1c; }

    .footer-note {
      margin-top: 10px;
      font-size: 12px;
      color: #6b7280;
      text-align: right;
    }
  </style>
</head>
<body>

  <div class="game-wrapper">
    <div class="game-header">
      <div class="title">â› è‹±æ–‡æŒ–ç¤¦éŠæˆ² v8</div>
      <div class="badge">å¯¶çŸ³ç‰ˆ B1L3 + B1L4 è‹±é¸ä¸­</div>
    </div>

    <div class="status-row">
      <div>
        <span class="status-label">ç›®å‰å¯¶çŸ³ï¼š</span>
        <span class="ore-display">
          <span id="oreIcons">ğŸ’ x 0</span>
          <span id="oreNumber"></span>
        </span>
      </div>
      <div id="roundInfo"></div>
    </div>

    <div style="text-align:center;">
      <div class="toolbar">
        <div class="toolbar-inner">
          <button id="mineBtn">
            <span class="icon">â›</span>
            <span class="label">æŒ–ç¤¦</span>
          </button>
        </div>
      </div>
    </div>

    <div id="questionArea">
      <div class="card" id="questionCard">
        <div id="lessonTag"></div>
        <div id="questionText">æŒ‰ä¸‹ã€ŒæŒ–ç¤¦ã€é–‹å§‹ä½ çš„è‹±æ–‡æŒ–ç¤¦ä¹‹æ—…ï¼</div>
        <div id="optionsArea"></div>
      </div>
    </div>

    <div id="message"></div>

    <div class="footer-note">æç¤ºï¼šæœ¬è¼ªæœƒå°‡é¡Œåº«å…¨éƒ¨å‡ºå®Œï¼Œå†ç”±ä½ æ±ºå®šè¦ä¸è¦é€²è¡Œä¸‹ä¸€è¼ªã€‚</div>
  </div>

  <script>
    const vocab = [
      { english: "recover",  chinese: "åº·å¾©",        lesson: "L3" },
      { english: "surgery",  chinese: "å¤–ç§‘æ‰‹è¡“",    lesson: "L3" },
      { english: "suffer",   chinese: "é­å—ï¼›å—è‹¦",  lesson: "L3" },
      { english: "disease",  chinese: "ç–¾ç—…",        lesson: "L3" },
      { english: "realize",  chinese: "å¯Ÿè¦ºï¼›æ„è­˜åˆ°",lesson: "L3" },
      { english: "describe", chinese: "æè¿°",        lesson: "L3" },
      { english: "couple",   chinese: "æƒ…ä¾¶ï¼›å¤«å¦»",  lesson: "L3" },
      { english: "encourage",chinese: "é¼“å‹µ",        lesson: "L3" },
      { english: "view",     chinese: "æ™¯è§€",        lesson: "L3" },
      { english: "imagine",  chinese: "æƒ³åƒ",        lesson: "L3" },
      { english: "remove",   chinese: "ç§»é™¤",        lesson: "L3" },
      { english: "reply",    chinese: "å›ç­”ï¼›å›è¦†",  lesson: "L3" },
      { english: "return",   chinese: "è¿”å›ï¼›æ­¸é‚„",  lesson: "L3" },
      { english: "shocked",  chinese: "éœ‡é©šçš„",      lesson: "L3" },
      { english: "blind",    chinese: "çœ¼ç›²çš„",      lesson: "L3" },
      { english: "whisper",  chinese: "ä½èªï¼›è€³èª",  lesson: "L3" },

      { english: "turn away",      chinese: "è½‰é ­ä¸çœ‹",   lesson: "L3 ç‰‡èª" },
      { english: "try one's best", chinese: "ç›¡å·±æ‰€èƒ½",   lesson: "L3 ç‰‡èª" },
      { english: "day after day",  chinese: "æ—¥å¾©ä¸€æ—¥",   lesson: "L3 ç‰‡èª" },
      { english: "in detail",      chinese: "è©³ç´°åœ°",     lesson: "L3 ç‰‡èª" },
      { english: "turn around",    chinese: "è½‰èº«",       lesson: "L3 ç‰‡èª" },
      { english: "pass away",      chinese: "éä¸–",       lesson: "L3 ç‰‡èª" },
      { english: "nothing but",    chinese: "åªæœ‰ï¼›åƒ…åƒ…", lesson: "L3 ç‰‡èª" },

      { english: "alarm",     chinese: "é¬§é˜",            lesson: "L4" },
      { english: "straight",  chinese: "ç›´æ¥åœ°",          lesson: "L4" },
      { english: "research",  chinese: "ç ”ç©¶",            lesson: "L4" },
      { english: "oversleep", chinese: "ç¡éé ­",          lesson: "L4" },
      { english: "amazing",   chinese: "ä»¤äººé©šå¥‡çš„",      lesson: "L4" },
      { english: "invent",    chinese: "ç™¼æ˜ï¼›å‰µé€ ",      lesson: "L4" },
      { english: "solve",     chinese: "è§£æ±º",            lesson: "L4" },
      { english: "regular",   chinese: "ä¸€èˆ¬çš„",          lesson: "L4" },
      { english: "chase",     chinese: "è¿½é€",            lesson: "L4" },
      { english: "promise",   chinese: "æ‰¿è«¾",            lesson: "L4" },
      { english: "design",    chinese: "è¨­è¨ˆ",            lesson: "L4" },
      { english: "position",  chinese: "æ“ºæ”¾",            lesson: "L4" },
      { english: "particular",chinese: "ç‰¹å®šçš„",          lesson: "L4" },
      { english: "create",    chinese: "å‰µé€ ",            lesson: "L4" },
      { english: "encounter", chinese: "é­é‡ï¼›é‡åˆ°",      lesson: "L4" },

      { english: "wake up",     chinese: "é†’ä¾†",          lesson: "L4 ç‰‡èª" },
      { english: "take action", chinese: "æ¡å–è¡Œå‹•",      lesson: "L4 ç‰‡èª" },
      { english: "get out of",  chinese: "é›¢é–‹ï¼›èµ°å‡º",    lesson: "L4 ç‰‡èª" },
      { english: "on time",     chinese: "æº–æ™‚",          lesson: "L4 ç‰‡èª" },
      { english: "go off",      chinese: "ï¼ˆé¬§é˜ï¼‰ç™¼å‡ºè²éŸ¿", lesson: "L4 ç‰‡èª" },
      { english: "in order to", chinese: "ç‚ºäº†â‹¯â‹¯",       lesson: "L4 ç‰‡èª" },
      { english: "in advance",  chinese: "äº‹å…ˆ",          lesson: "L4 ç‰‡èª" }
    ];

    let ore = 0;
    let currentQuestion = null;
    let isQuestionActive = false;

    let pool = [];
    let poolIndex = 0;

    let oreIconsSpan, oreNumberSpan, mineBtn,
        questionText, optionsArea, messageDiv,
        lessonTag, roundInfo, questionCard;

    const clapSounds = [
      new Audio("clap_A.wav"),
      new Audio("clap_B.wav"),
      new Audio("clap_C.wav")
    ];

    const correctMessages = [
      "âœ” ç­”å°ï¼ä½ æŒ–åˆ°ä¸€é¡†é«˜ç´šå¯¶çŸ³ï¼ŒåŒæ™‚ä¹Ÿç·´äº†ä¸€ä¸‹è…¦è‚Œè‚‰ã€‚",
      "âœ” å®Œç¾ï¼è‹±æ–‡è…¦ä¸Šç·šä¸­ï¼Œå¯¶çŸ³è‡ªå·±è·³é€²èƒŒåŒ…ã€‚",
      "âœ” Niceï¼å¦‚æœå–®å­—ä¹Ÿæœ‰é‘½çŸ³ç­‰ç´šï¼Œä½ å·²ç¶“åœ¨å‚³èªªæ®µä½ã€‚",
      "âœ” å‘½ä¸­ç­”æ¡ˆï¼ç¤¦å·¥å…¬æœƒæ±ºå®šå¹«ä½ åŠ è–ªï¼ˆåŠ åœ¨å¯¶çŸ³æ•¸é‡è£¡ï¼‰ã€‚",
      "âœ” å¤ªå¼·äº†ï¼é€™é¡Œæ ¹æœ¬æ˜¯é€åˆ†å¯¶çŸ³ï¼Œè¢«ä½ è¼•é¬†æŒ–èµ°ã€‚"
    ];

    const wrongMessages = [
      "âœ˜ é€™é¡Œæ²’æŒ–åˆ°å¯¶çŸ³ï¼Œä½†æŒ–åˆ°äº†éœ€è¦è¤‡ç¿’çš„å–®å­—ã€‚",
      "âœ˜ å·®ä¸€é»é»ï¼å†æŒ–å¹¾æ¬¡ï¼Œé€™é¡†å¯¶çŸ³å°±æœƒè®Šæˆä½ çš„ã€‚",
      "âœ˜ å–”å–”ï½å¯¶çŸ³æºœèµ°äº†ï¼Œä¸‹æ¬¡ç”¨è‹±æ–‡æŠŠå®ƒæŠ“å›ä¾†ã€‚",
      "âœ˜ æ²’é—œä¿‚ï¼Œç¤¦å‘å¾ˆå¤šé¡Œï¼ŒéŒ¯ä¸€é¡Œåªæ˜¯æš–èº«ã€‚",
      "âœ˜ æŒ–ç©ºäº†é€™ä¸€æ ¼ï¼Œä½†ä½ å¤šè¨˜ä½äº†ä¸€å€‹æ­£ç¢ºç­”æ¡ˆã€‚"
    ];

    const optionColors = [
      "#FF9EC7", "#C39BFF", "#7EDCFF", "#6AA9FF",
      "#8CFFC4", "#A4FF7E", "#FFD18B", "#FFF49A"
    ];

    function shuffle(array) {
      for (let i = array.length - i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    function resetPool() {
      pool = shuffle(vocab.slice());
      poolIndex = 0;
      updateRoundInfo();
    }

    function updateRoundInfo() {
      if (!roundInfo) return;
      roundInfo.textContent = "æœ¬è¼ªé€²åº¦ï¼š" + poolIndex + " / " + vocab.length;
    }

    function updateOreDisplay() {
      const maxIcons = 10;
      const iconsCount = Math.min(ore, maxIcons);
      let icons = "";
      if (iconsCount > 0) {
        icons = "ğŸ’".repeat(iconsCount);
        if (ore > maxIcons) {
          icons += " +" + (ore - maxIcons);
        }
      } else {
        icons = "ğŸ’ x 0";
      }
      oreIconsSpan.textContent = icons;
      oreNumberSpan.textContent = ore > 0 ? "(" + ore + ")" : "";
    }

    function randomFrom(arr) {
      return arr[Math.floor(Math.random() * arr.length)];
    }

    function playRandomClap() {
      const sound = randomFrom(clapSounds);
      try {
        sound.currentTime = 0;
        sound.play();
      } catch (e) {}
    }

    function startMining() {
      if (isQuestionActive) {
        alert("è«‹å…ˆå›ç­”ç›®å‰é€™ä¸€é¡Œå–”ï¼");
        return;
      }
      if (vocab.length < 4) {
        alert("é¡Œåº«è‡³å°‘éœ€è¦ 4 å€‹å–®å­—æ‰å¯ä»¥å‡ºå››é¸ä¸€å–”ã€‚");
        return;
      }

      if (pool.length !== 0 && poolIndex >= pool.length) {
        const goNext = confirm(
          "æœ¬è¼ªé¡Œç›®å·²å…¨éƒ¨å®Œæˆï¼\nç›®å‰å…±ç²å¾—å¯¶çŸ³ï¼š" + ore +
          " é¡†ã€‚\n\nè¦å†ä¾†ä¸€è¼ªç·´ç¿’å—ï¼Ÿ"
        );
        if (!goNext) {
          messageDiv.textContent = "æœ¬è¼ªç·´ç¿’çµæŸï¼Œå¯ä»¥ä¼‘æ¯ä¸€ä¸‹ï¼Œæˆ–é—œé–‰ç•«é¢ã€‚";
          messageDiv.className = "";
          return;
        }
        resetPool();
      }

      if (pool.length === 0) resetPool();

      const item = pool[poolIndex];
      poolIndex++;
      updateRoundInfo();

      const correctChinese = item.chinese;
      const options = [correctChinese];

      while (options.length < 4) {
        const candidate = vocab[Math.floor(Math.random() * vocab.length)].chinese;
        if (!options.includes(candidate)) {
          options.push(candidate);
        }
      }

      shuffle(options);

      currentQuestion = {
        english: item.english,
        correctChinese: correctChinese,
        lesson: item.lesson,
        options: options
      };
      isQuestionActive = true;

      questionCard.classList.remove("pop");
      void questionCard.offsetWidth;
      questionCard.classList.add("pop");

      lessonTag.textContent = "å‡ºè™•ï¼š" + item.lesson;
      questionText.textContent = "è«‹é¸å‡ºã€Œ" + item.english + "ã€çš„æ­£ç¢ºä¸­æ–‡æ„æ€ï¼š";
      optionsArea.innerHTML = "";

      options.forEach(function(opt) {
        const btn = document.createElement("button");
        btn.textContent = opt;
        btn.className = "option-btn";

        const color = randomFrom(optionColors);
        btn.style.backgroundColor = color;
        btn.style.borderColor = color;

        btn.onclick = function () { checkAnswer(opt); };
        optionsArea.appendChild(btn);
      });

      messageDiv.textContent = "";
      messageDiv.className = "";
    }

    function checkAnswer(selectedChinese) {
      if (!isQuestionActive) return;

      if (selectedChinese === currentQuestion.correctChinese) {
        ore += 1;
        updateOreDisplay();
        messageDiv.textContent =
          randomFrom(correctMessages) + "ï¼ˆç­”æ¡ˆï¼š" + currentQuestion.correctChinese + "ï¼‰";
        messageDiv.className = "correct";
        playRandomClap();
      } else {
        messageDiv.textContent =
          randomFrom(wrongMessages) + " æ­£è§£æ˜¯ï¼šã€Œ" + currentQuestion.correctChinese + "ã€ã€‚";
        messageDiv.className = "wrong";
      }

      isQuestionActive = false;
      currentQuestion = null;
      questionText.textContent = "å†æŒ‰ä¸€æ¬¡ã€ŒæŒ–ç¤¦ã€ï¼ŒæŒ‘æˆ°ä¸‹ä¸€é¡Œï¼";
      optionsArea.innerHTML = "";
    }

    window.onload = function() {
      oreIconsSpan = document.getElementById("oreIcons");
      oreNumberSpan = document.getElementById("oreNumber");
      mineBtn      = document.getElementById("mineBtn");
      questionText = document.getElementById("questionText");
      optionsArea  = document.getElementById("optionsArea");
      messageDiv   = document.getElementById("message");
      lessonTag    = document.getElementById("lessonTag");
      roundInfo    = document.getElementById("roundInfo");
      questionCard = document.getElementById("questionCard");

      mineBtn.addEventListener("click", startMining);
      mineBtn.classList.add("attention");
      resetPool();
      updateOreDisplay();
    };
  </script>

</body>
</html>
